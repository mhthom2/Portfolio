---
title: "Analysis of Guinea Pig Tooth Growth"
author: "Matthew Thomas"
date: "`r Sys.Date()`"
output: html_document
---

```{r echo=FALSE}
suppressMessages({
        suppressWarnings(
        {
                library(dplyr)          # easier data frame manipulation
                library(ggplot2)        # plotting charts 
        })
})
```
## Inferential Data Analysis of Guinea Pig Tooth Growth

### Summary of the Tooth Growth Data
This data set contains data on the response is the length of odontoblasts, cells responsible for tooth growth, in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid, a form of vitamin C.

In this analysis, we'd like to determine which combination of supplement and dosage was linked to the highest tooth growth. 

```{r echo=FALSE}
# Load data 
data(ToothGrowth)
``` 

```{r echo=FALSE}
str(ToothGrowth)
```

The `len` column represents the length of the tooth, the `supp` column identifies the type of supplement, either `OJ` for orange juice and `VC` for absobic acid, and `dose` is the dose in milligrams per day. 

```{r echo=FALSE}
# Statistical summary of features and response
summary(ToothGrowth)
```

The tooth length data are continuous, numeric values, and the supplements are of type factor, which is how categorical variables are stored in R. Because there are only three dosage levels, we decided to assume that they were categorical variables, so we converted them to the factor data type. 

```{r echo=FALSE}
# Convert dose to factor, categorical variable 
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
```

### Visualize Differences between Supplements and Dosages
To determine which combination of supplement and dosage performed best, we first created a box plot comparing dosage and tooth length, as grouped by the type of supplement. 

```{r echo=FALSE, fig.height=4, fig.width=6}
# Colors of boxes 
cols <- c('lightblue2','lightpink2')

# Plot data 
ggplot(ToothGrowth, aes(x=dose, y=len, fill=supp)) +
        geom_boxplot() +
        labs(x = "Dosage", y = "Tooth Length",
             fill='Supplement',
             title='Comparison of Tooth Growth in Guinea Pigs\n by Dosage and Supplement') +
        scale_fill_manual(labels=c('Orange Juice', 'Absorbic Acid'),
                          values=cols)
```

Analyzing the box plot, we saw a couple of general trends in the data. First, as the dosage increased, the tooth length increased. This general trend is true for both type of supplements. And second, for most dosage levels, orange tends to lead to larger tooth lengths. The one notable expectation is at the highest dosage, 2.0 mg/day. Although the absorbic acid supplement seemed to have more variability, the median values appear to be the same.  

### Hypothesis Tests Comparing Tooth Growth by Supplement and Dosage. 
In our analysis, we first determined which dosage level led to the highest tooth length for each supplement. Then we compared each supplement at their best dosage levels. 

To determine which dosage level led to the highest tooth length for each supplement, we did two single-sided, pairwise t-tests for each supplement. We first compared each supplement at the 0.5 and 1.0 mg/day levels. Then we compared the best-performing dosage level from this comparison with the 2.0 mg/day dosage level.

We chose t-tests, because 1000 isn't a high number of data points, and these tests perform better with small data sets. From box plot analysis, we were confident that the higher dosages would perform better, so we decided it wasn't necessary to perform two-sided tests. Also, because we only performed a few tests, we decided that corrected for the multiple tests performed wasn't necessary. 

#### Comparing Orange Juice Dosage Levels:
***Test 1:*** Comparing 0.5 and 1.0 mg/day dosages. 

$H_0$: The lengths of the teeth using the 0.5 dosage of orange juice have the same distribution as those using the 1.0 dosage. 

$H_a$: They don't have the same distribution. 

Assuming $\alpha=0.05$:

```{r echo=FALSE}
# Separate orange juice supplement data 
grow_OJ <- subset(ToothGrowth, supp == 'OJ')

# Select just 0.5 and 1.0 dosages 
grow_OJ_051 <- subset(grow_OJ, dose %in% c(0.5, 1))
# Test doses 0.5 and 1.0 
t_test <- t.test(len ~ dose, paired = FALSE, var.equal = FALSE, data = grow_OJ_051)

# Print p-value and confidence interval
print(paste('The p-value is :', t_test$p.value, 'and the t-score is :', t_test$statistic))

```

Because the p-value is essentially zero, we rejected the null hypothesis and accepted the alternate hypothesis that the two dosages don't have the same distribution. If they did, we'd expect their differences to be close to zero. Because the t-score is negative, we concluded that the second group, the 1.0 dosage group, performed best. 

So for the second test, we compared the tooth lengths for the 1.0 dosage and the 2.0 dosage. 

***Test 2:*** Comparing 1.0 and 2.0 mg/day dosages. 

$H_0$: The lengths of the teeth using the 1.0 dosage of orange juice have the same distribution as those using the 2.0 dosage. 

$H_a$: They don't have the same distribution. 

Assuming $\alpha=0.05$:

```{r echo=FALSE}
# Select 1.0 and 2.0 dosages
grow_OJ_12 <- subset(grow_OJ, dose %in% c(2, 1))
# Perform t-test 
t_test <- t.test(len ~ dose, paired = FALSE, var.equal = FALSE, data = grow_OJ_12)

# Print p-value and confidence interval
print(paste('The p-value is :', t_test$p.value, 'and the t-score is :', t_test$statistic))
```

Although the results were much closer than the previous test, the p-value of `0.04` is less the $\alpha$ value. Therefore, we rejected the null hypothesis and accepted the alternate hypothesis. Because the t-score is negative, we concluded that the second group at 2.0 dosage level performed best. 

Therefore, the 2.0 mg/day level produced the best results for this supplement.

#### Comparing Absorbic Acid Dosage Levels:
***Test 1:*** Comparing 0.5 and 1.0 mg/day dosages. 

$H_0$: The lengths of the teeth using the 0.5 dosage of absorbic acid have the same distribution as those using the 1.0 dosage. 

$H_a$: They don't have the same distribution. 

Assuming $\alpha=0.05$:

```{r echo=FALSE}
# Separate absorbic acid data, coded as 'VC'
grow_VC <- subset(ToothGrowth, supp == 'VC')

# Select just 0.5 and 1.0 dosage levels
grow_VC_051 <- subset(grow_VC, dose %in% c(0.5, 1))
# Perform t-test 
t_test <- t.test(len ~ dose, paired = FALSE, var.equal = FALSE, data = grow_VC_051)

# Print p-value and confidence interval
print(paste('The p-value is :', t_test$p.value, 'and the t-score is :', t_test$statistic))
```

Using our given $\alpha$ value and a p-value of about zero, we again rejected the null hypothesis and accepted that the distribution of the two dosage levels aren't the same. The t-score is also negative, so we concluded that the 1.0 level performed better. 

So for the second test, we compared the tooth lengths for the 1.0 dosage and the 2.0 dosage. 

***Test 2:*** Comparing 1.0 and 2.0 mg/day dosages. 

$H_0$: The lengths of the teeth using the 1.0 dosage of absorbic acid have the same distribution as those using the 2.0 dosage. 

$H_a$: They don't have the same distribution. 

Assuming $\alpha=0.05$:

```{r echo=FALSE}
# Select 1.0 and 2.0 dosages 
grow_VC_12 <- subset(grow_VC, dose %in% c(1, 2))
# Perform t-test
t_test <- t.test(len ~ dose, paired = FALSE, var.equal = FALSE, data = grow_VC_12)

# Print p-value and confidence interval
print(paste('The p-value is :', t_test$p.value, 'and the t-score is :', t_test$statistic))
```

Again, using our given $\alpha$ value and a p-value of about zero, we rejected the null hypothesis and accepted that the alternative. The t-score is negative, so we concluded that second group with the 2.0 level performed better.

Therefore, the 2.0 mg/day level produced the best results for this supplement too.

#### Comparing Orange Juice and Absorbic Acid at 2.0 mg/day:
After our exploratory analysis, we expected the highest dosages of each supplement to perform best, and they did. Next, we wanted to determine whether orange juice or absorbic acid performed better at the maximum dosage 2.0 mg/day. 

$H_0$: The lengths of the teeth using the 2.0 dosage of orange juice have the same distribution as those using the 2.0 dosage of absorbic acid. 

$H_a$: They don't have the same distribution. 

Assuming $\alpha=0.05$:

```{r echo=FALSE}
# Select entries for each supplement 
grow_OJ_2 = subset(grow_OJ, dose == 2)
grow_VC_2 = subset(grow_VC, dose == 2)
# Combine into a single data frame 
grow_2 <- rbind(grow_OJ_2, grow_VC_2)
# Perform t-test 
t_test <- t.test(len ~ supp, paired = FALSE, var.equal = FALSE, data = grow_2)

# Print p-value and confidence interval
print(paste('The p-value is :', t_test$p.value, 'and the t-score is :', t_test$statistic))
```

Because the $\alpha$ value is `0.05` and the p-value was 0.96, we accepted the null hypothesis. Also, the t-score is close to zero, so we confirmed that both types of supplements likely had the same distribution. In other words, it doesn't matter which supplement is used. The most impactful feature was the dosage, which was 2.0 mg/day. 


### Dosage, not Supplement, Shows Greater Impact
Therefore, we concluded that the type supplement didn't impact the results. Either supplement seems to improve tooth growth. However, the size of the dose did impact the results. In all of our tests, the larger the dosage, the better the results. So we recommend that a 2.0 mg/day dosage of either supplement be used to improve tooth growth in guinea pigs. 

Our conclusions are based the results of several t-tests. When performing these tests, we made several assumptions. First, to use t-tests, we assumed that the data were independent and identically distributed. We also assumed that the variance across the data were not the same. And finally, we assumed that there were no accumulative effects from the multiple tests. 
